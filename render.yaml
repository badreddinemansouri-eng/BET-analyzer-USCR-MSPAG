services:
  - type: web
    name: bet-xrd-morphology
    env: python
    plan: free
    # Force pip, disable Poetry
    buildCommand: |
      # Explicitly disable Poetry
      export POETRY_VIRTUALENVS_CREATE=false
      unset PIP_REQUIRE_VIRTUALENV
      
      # Upgrade pip and install setuptools first
      pip install --upgrade pip setuptools==68.2.2 wheel==0.42.0
      
      # Install requirements
      pip install -r requirements.txt
      
      # Create Streamlit config
      mkdir -p ~/.streamlit/
      echo "[server]
      headless = true
      port = \$PORT
      enableCORS = false
      enableXsrfProtection = false
      " > ~/.streamlit/config.toml
      
    startCommand: streamlit run app.py
