services:
  - type: web
    name: bet-xrd-morphology
    env: python
    plan: free
    buildCommand: |
      # Disable Poetry explicitly
      export POETRY_VIRTUALENVS_CREATE=false
      
      # Install without building numpy from source
      pip install --upgrade pip
      pip install numpy==1.26.4  # Version with Python 3.13 wheels
      pip install -r requirements.txt
      
      mkdir -p ~/.streamlit/
      echo "[server]
      headless = true
      port = \$PORT
      enableCORS = false
      enableXsrfProtection = false
      " > ~/.streamlit/config.toml
      
    startCommand: streamlit run app.py
